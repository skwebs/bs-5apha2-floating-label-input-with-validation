<!DOCTYPE html>
<html lang="en-IN">

<head prefix="og: https://ogp.me/ns# ">
	<!-- Required meta tags -->
	<title>:: Floating label input field with bootstrap.::</title>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Floating label input field with bootstrap 5.0.0-alpha2 with proper validation." />
	<meta name="keywords" content="Floating label input fields, Bootstrap floating label input, Floating label input with proper validation, " />
	<meta name="theme-color" content="#0c5ca2">
	<!--<meta name="theme-color" content="#0d123d">-->
	<!-- Required og:image tags -->
	<meta property="og:image" content="https://skwebs.github.io/bs-5apha2-floating-label-input-with-validation/assets/img/skwebs-logo.png">
	<meta property="og:image:url" content="https://skwebs.github.io/bs-5apha2-floating-label-input-with-validation/assets/img/skwebs-logo.png">
	<!-- Required favicon -->
	<link rel="icon" type="image/png" href="https://skwebs.github.io/bs-5apha2-floating-label-input-with-validation/assets/img/skwebs-logo.png" sizes="16x16,32x32,64x64">
	<!-- all css vendors file-->
	<link rel="stylesheet" href="./assets/vendors/font-awesome/4.7.0/css/font-awesome.min.css" />
	<link rel="stylesheet" href="./assets/vendors/bootstrap/5.0.0-alpha2/bootstrap.min.css" />
	<link rel="stylesheet" href="./assets/vendors/bootstrap/5.0.0-alpha2/bs5a2-reset-sm.css" />
	<link rel="stylesheet" href="./assets/vendors/jquery-ui/1.12.1/jquery-ui.min.css">
	<link rel="stylesheet" href="./assets/vendors/sweetalert2/10.6.1/sweetalert2.min.css" />
	<link rel="stylesheet" href="./assets/vendors/cropperjs/1.5.9/cropper.min.css" />
	
	<link rel="stylesheet" href="./assets/css/style.css?v1.1" />
	<link rel="stylesheet" href="./assets/css/floating-label-input.css" />
	<!-- all page css -->
	<style type="text/css"media="screen and (max-height: 900px)" >
	</style>
	<style>

	
* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
	font-family: sans-serif;
}
body {
	background-image: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.8)), url(https://images.pexels.com/photos/994605/pexels-photo-994605.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500);
	background-position: center;
	background-size: cover;
	background-repeat: no-repeat;
}
main {position:relative;}


.containers {
	width: 360px;
	height: 450px;
	margin: auto;
	background: #fff;
	border-radius: 5px;
	position:absolute;
	top:calc( 50% - 235px + 28px );
	left: calc( 50% - 180px);
	overflow: hidden;
}

h1 {
	text-align: center;
	margin-bottom: 35px;
	color: #777;
	font-size:2rem;
}

.containers .tab{
	width: 280px;
	position: absolute;
	top: 75px;
	left: 40px;
	transition: .5s;
}
.imgBox{
position:relative;
top:0;
left:0;
width:200px;
height:200px;
display:block;
background:red;
}
.imgBox label,#user-img {
position:absolute;
top:0;
left:0;
padding:0 ;
width:inherit;
height:inherit;
}

::placeholder {
	color: #777;
}

.btn-box {
	width: 100%;
	margin: 30px auto;
	text-align: center;
}

.tab button {
	width: 110px;
	height: 35px;
	margin: 0 10px;
	background-image: linear-gradient(to right, #ff105f, #ffad06);
	border-radius: 30px;
	border: 0;
	outline: none;
	color: #fff;
	cursor: pointer;
}

#tab2 ,#tab3, #tab4 {
	left: 450px;
}

.step-button {
	width: 360px;
	height: 40px;
	margin: 0 auto;
	display: flex;
	align-items: center;
	box-shadow: 0 -1px 5px -1px #000;
	position: relative;
}

.step-col {
	width: 90px;
	text-align: center;
	color: #ccc;
	position: relative;
}

#progress {
	position: absolute;
	height: 100%;
	width: 90px;
	/*background-image:linear-gradient(to right, #ff105f, #ffad06);
*/
	background: green;
	transition: .5s;
}

#progress::after {
	content: '';
	height: 0;
	width: 0;
	border-top: 20px solid transparent;
	border-bottom: 20px solid transparent;
	position: absolute;
	top: 0;
	right: -19.9px;
	/*border-left:20px solid #ffad06;*/
	border-left: 20px solid green;
}


.cropBox, .cropBox img{
width:200px;
height:200px;
background:red;
position:relative;
}
.modal-content{
width:360px !important;
}
	</style>
</head>

<body>
	<header class="header" >
		<nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light">
			<div class="container"> <a class="navbar-brand" href="#">SKWebs</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button>
				<div class="collapse navbar-collapse " id="navbarNav">
					<ul class="navbar-nav ml-auto">
						<li class="nav-item">
							<a class="nav-link" href="./">Home</a>
						</li>

<li class="nav-item">
<a class="nav-link" href="simple-msform.html">Simple Multi Step Form</a>
</li>
<li class="nav-item">
<a class="nav-link active" href="nice-msform.html">Nice Multi Step Form</a>
</li>
<li class="nav-item">
<a class="nav-link" href="animated-msform.html">Animated Multi Step Form</a>
</li>

						<li class="nav-item">
							<a class="nav-link" href="pure-css-float-label-input.html">Pure CSS Float Label Input</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="https://github.com/skwebs/bs-5apha2-floating-label-input-with-validation">Github</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="https://github.com/skwebs/bs-5apha2-floating-label-input-with-validation/archive/master.zip">Download Code</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
	<main>
		<div class="containers">
			<form id="tab1" class="tab" >
				<h1>CREATE ACCOUNT</h1>
				<div class="form-group ">
					<input name="first_name"  
						id="first_name" 
						type="text" 
						class="inp form-control form-control-lg" 
						data-field-name="First Name" 
						title="Only alphabet characters are allowed. First Name must have minimum 3 characters, start with capital letter." 
						data-toggle="tooltip" 
						data-title="Only alphabet characters are allowed. <strong>First Name</strong> must have minimum 3 characters, start with capital letter." 
						autofocus="autofocus" 
						placeholder=" " 
						required 
						oninput="validateInp(this)" 
					pattern="^[A-Z]{1}[a-z]{2,10}$" >
					<label for="first_name" class="form_label">First Name</label>
				</div>
		
				<div class="form-group">
					<input name="mid_name"  
						id="mid_name" 
						type="text" 
						class="inp form-control form-control-lg" 
						data-field-name="Middle Name" 
						title="Only alphabet characters are allowed. Middle Name must have minimum 3 characters, start with capital letter." 
						data-toggle="tooltip" 
						data-title="Only alphabet characters are allowed. <strong>Middle Name</strong> must have minimum 3 characters, start with capital letter." 
						placeholder=" " 
						oninput="validateInp(this)" 
					pattern="^(\s*|[A-Z]{1}[a-z]{2,10})$">
					<label for="mid_name" class=" text-md-right">Middle Name</label>
				</div>
					
				<div class="form-group">
					<input name="last_name"  
						id="last_name" 
						type="text" 
						class="inp form-control form-control-lg" 
						data-field-name="Last Name" 
						title="Only alphabet characters are allowed. Last Name must have minimum 3 characters, start with capital letter." 
						data-toggle="tooltip" 
						data-title="Only alphabet characters are allowed. <strong>Last Name</strong> must have minimum 3 characters, start with capital letter." 
						placeholder=" " 
						required 
						oninput="validateInp(this)" 
					pattern="^[A-Z]{1}[a-z]{2,10}$" >
					<label for="last_name" class="">Last Name</label>
				</div>
				<div class="btn-box">
					<button id="Next1">Next</button>
				</div>
			</form>
			<form id="tab2" class="tab" >
				<h1>SOCIAL LINKS</h1>
				<div class="form-group">
					<select name="class" 
						id="class"  
						class="inp form-select form-select-lg" 
						data-field-name="Class" 
						title="Class is required field . Please select an option." 
						data-title="<strong>Class</string> is required field . Please select an option." 
						required 
						onchange="validateInp(this)" 
					pattern="[^\0]" >
					
					<option value=""></option>
					<option value="10+" >10+</option>
					<option value="10" >10th</option>
					<option value="9" >9th</option>
					<option value="8" >8th</option>
					<option value="7" >7th</option>
					<option value="6" >6th</option>
					<option value="5" >5th</option>
					<option value="4" >4th</option>
					<option value="3" >3rd</option>
					<option value="2" >2nd</option>
					<option value="1" >1st</option>
					</select>
					<label for="class" class="">Class</label>
				</div>
					
				<div class="form-group">
					<select name="gender" 
						id="class"  
						class="inp form-select form-select-lg" 
						data-field-name="Gender" 
						title="Gender is required field . Please select an option." 
						data-title="<strong>Gender</string> is required field . Please select an option." 
						placeholder=" " 
						required 
						onchange="validateInp(this)" 
					pattern="[^\0]" >
					
					<option value=""></option>
					<option value="Female" >Female</option>
					<option value="Male" >Male</option>
					<option value="Other" >Other</option>
					</select>
					<label for="gender" class="">Gender</label>
				</div>
					
				<div class="form-group">
					<input name="dob"  
						id="dob" 
						type="text"  
						class="inp form-control form-control-lg" 
						data-field-name="Date of Birth" 
						title="Date of birth is required field. Please select an option." 
						data-title="Please must select your <strong>date of birth</strong>."  
						placeholder=" "
						required 
						oninput="validateInp(this)" 
						onchange="validateInp(this)" 
					pattern="^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[13-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$" >
					<label for="dob" class="">Date of Birth</label>
				</div>
				<div class="btn-box">
					<button type="button" id="Back1">Back</button>
					<button type="button" id="Next2">Next</button>
				</div>
			</form>
			<form id="tab3" class="tab" >
				<h1>PERSONAL INFO</h1>
				<div class="form-group">
					<input name="mobile" 
						type="tel"  
						data-toggle="tooltip" 
						title="Only 10 digits mobile no. allowed that starts with 6,7,8 or,9." 
						id="mobile" 
						data-field-name="Mobile No." 
						data-title="Only 10 digits <strong>mobile no.</strong> allowed that starts with 6,7,8 or,9." 
						maxlength="10"  
						class="inp form-control form-control-lg" 
						placeholder=" " 
						required
						oninput="validateInp(this)" 
					pattern="^[6-9]\d{9}$" >
					<label for="mobile" class="">Mobile No.</label>
				</div>
				<div class="form-group">
					<input type="text" 
						id="father"  
						data-toggle="tooltip" 
						title="Only alphabet, space and dot(.) are allowed in father's name, Must start with capital letter." 
						class="inp form-control form-control-lg" 
						name="father" 
						data-field-name="Father's Name" 
						data-title="Only alphabet, space and dot(.) are allowed in <strong>father's name</strong>, Must start with capital letter." 
						placeholder=" " 
						required
						oninput="validateInp(this)" 
					pattern="^([A-Z][a-z]{2,}|[A-Z][a-z]*(\s|.\s|.|)[A-Z][a-z]{2,}|[A-Z][a-z]*(\s|.\s|.|)[A-Z][a-z]*(\s|.\s|.|)[A-Z][a-z]{2,})$" >
					<label for="father_name" class="">Father's Name</label>
				</div>
				
				<div class="form-group">
					<input type="text" 
						id="present_address" 
						name="present_address"  
						data-field-name="Present Address" 
						data-toggle="tooltip" 
						data-title="Only alphanumeric, space and , . - + symbols are allowed in  <strong>present address</strong> field." 
						class="inp form-control form-control-lg" 
						title="Only alphanumeric, space and , . - + symbols are allowed in  present address field." 
						placeholder=" " 
						required
						oninput="validateInp(this)" 
					pattern="^[A-Z][a-zA-Z0-9\s,+-\.]+$" >
					<label for="present_address" class="">Present Address</label>
				</div>
				<div class="btn-box">
					<button type="button" id="Back2">Back</button>
					<button type="button" id="Next3">Next</button>
				</div>
			</form>
			<form id="tab4" class="tab" >
				<h1>UPLOAD IMAGE</h1>
				<div class="imgBox mx-auto" >
					<label for="select-img">
					<img id="user-img" src="./assets/img/wa-sq-user-img.png">
					</label>
					<input id="select-img" type="file" class="visually-hidden" >
				</div>
				<div class="btn-box">
					<button type="button" id="Back3">Back</button>
					<button type="button" id="finish">Submit</button>
				</div>
			</form>
			<div class="step-button">
			<div id="progress"></div>
				<div class="step-col"><small>Step 1</small></div>
				<div class="step-col"><small>Step 2</small></div>
				<div class="step-col"><small>Step 3</small></div>
				<div class="step-col"><small>Step 4</small></div>
			</div>
		</div>


	</main>
	<footer class="bg-light text-muted">
		<div class="text-center p-4 small-text d-none">Hi, I am Satish. I like coding and always try to create modern code for beginners.</div>
		<!-- copyright section -->
		<section class="copyright my-auto py-4 text-center "> &copy;
			<script>
			document.write(new Date().getFullYear())
			</script> Designed &amp; Developed by <a href="https://skwebs.github.io">SKWebs</a> </section>
		<!-- // copyright section -->
	</footer>


<!-- extra -->
<!-- Modal -->
<div class="modal fade" id="cropImageModal" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content rounded-0 mx-auto">
      <div class="modal-header bg-primary text-white rounded-0">
        <h5 class="modal-title" id="cropImageModalLabel">Crop Image</h5>
        <button type="button" class="btn-close btn-close-white" data-dismiss="modal" aria-label="Close" title="Close"  data-toggle="tooltip"></button>
      </div>
      <div class="modal-body">
       <div class="cropBox mx-auto" >
	       <img id="croppable-img" src="https://cfcoaching.000webhostapp.com/img/wa-sq-user-img.png">
       </div>
      </div>
      <div class="modal-footer rounded-0 bg-light">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" title="Close" data-toggle="tooltip"><i class="fa fa-times" aria-hidden="true"></i></button>
        <button data-tool="reset" type="button" class="btn btn-primary" title="Reset" data-toggle="tooltip"><i class="fa fa-refresh" aria-hidden="true"></i></button>
        <div class="btn-group" role="group">
	        <button data-tool="flipX" id="flipX" type="button" class="tool btn btn-primary" title="Flip Horizontally" data-toggle="tooltip"><i class="fa fa-arrows-h" aria-hidden="true"></i></button>
	        <button data-tool="flipY" id="flipY" type="button" class="tool btn btn-primary" title="Flip Vertically" data-toggle="tooltip"><i class="fa fa-arrows-v" aria-hidden="true"></i></button>
        </div>
        <div class="btn-group" role="group">
	        <button data-tool="rotateLeft" id="rotateLeft" type="button" class="tool btn btn-primary" title="Rotate (-45)" data-toggle="tooltip"><i class="fa fa-undo" aria-hidden="true"></i></button>
	        <button data-tool="rotateRight" id="rotateRight" type="button" class="tool btn btn-primary" title="Rotate (+45)" data-toggle="tooltip"><i class="fa fa-repeat" aria-hidden="true"></i></button>
        </div>
        <button id="cropBtn" type="button" class="btn btn-success" title="Crop Image" data-toggle="tooltip"><i class="fa fa-crop" aria-hidden="true"></i></button>
      </div>
    </div>
  </div>
</div>
<!-- all vendors js file-->
<script src="./assets/vendors/jquery/3.5.1/jquery.min.js"></script>
<script src="./assets/vendors/bootstrap/5.0.0-alpha2/bootstrap.bundle.min.js"></script>
<script src="./assets/vendors/jquery-ui/1.12.1/jquery-ui.datepicker.min.js"></script>
<script src="./assets/vendors/sweetalert2/10.6.1/sweetalert2.min.js"></script>
<script src="./assets/vendors/cropperjs/1.5.9/cropper.min.js" ></script>

<script defer src="./assets/js/ap.js"></script>
<script type="text/javascript">
"use strict";
//$("#cropImageModal").modal();
var tab1 = document.querySelector("#tab1");
var tab2 = document.querySelector("#tab2");
var tab3 = document.querySelector("#tab3");
var tab4 = document.querySelector("#tab4");
var Next1 = document.querySelector("#Next1");
var Next2 = document.querySelector("#Next2");
var Next3 = document.querySelector("#Next3");
var Back1 = document.querySelector("#Back1");
var Back2 = document.querySelector("#Back2");
var Back3 = document.querySelector("#Back3");
var progress = document.querySelector("#progress");
var isImageCropped = !1;
var croppedImgBlobData = "";
var fd = new FormData();
Next1.onclick = function(e) {
	e.preventDefault();
	if(validateForm(tab1) === true) {
		storeData(tab1,"tab1");
		//tab1.style.transform = "scale(0)";
		//tab2.style.transform = "scale(1)";
		
		tab1.style.left = "-450px";
		tab2.style.left = "40px";
		progress.style.width = "180px";
	}
}
Next2.onclick = function(e) {
	e.preventDefault();
	if(validateForm(tab2) === true) {
		storeData(tab2,"tab2");
		//tab2.style.transform = "scale(0)";
		//tab3.style.transform = "scale(1)";
		tab2.style.left = "-450px";
		tab3.style.left = "40px";
		progress.style.width = "270px";
	} 
}
Next3.onclick = function(e) {
	e.preventDefault();
	if(validateForm(tab3) === true) {
		storeData(tab3,"tab3");
		//tab2.style.transform = "scale(0)";
		//tab3.style.transform = "scale(1)";
		tab3.style.left = "-450px";
		tab4.style.left = "40px";
		progress.style.width = "360px";
	} 
}
Back1.onclick = function(e) {
	e.preventDefault();
	//tab1.style.transform = "scale(1)";
	//tab2.style.transform = "scale(0)";
	
	tab1.style.left = "40px";
	tab2.style.left = "450px";
	progress.style.width = "90px";
}
Back2.onclick = function(e) {
	e.preventDefault(e);
	//tab2.style.transform = "scale(1)";
	//tab3.style.transform = "scale(0)";
	
	tab2.style.left = "40px";
	tab3.style.left = "450px";
	progress.style.width = "180px";
}
Back3.onclick = function(e) {
	e.preventDefault(e);
	//tab2.style.transform = "scale(1)";
	//tab3.style.transform = "scale(0)";
	
	tab3.style.left = "40px";
	tab4.style.left = "450px";
	progress.style.width = "270px";
}
document.querySelector("#finish").onclick = function(e) {
	e.preventDefault();
	//if(validateForm(tab4) === true) {
	if(isImageCropped){
		let allDataObj = Object.assign(getData("tab1"),getData("tab2"),getData("tab3"));
		let allDataStr = JSON.stringify(allDataObj);
		subForm(allDataObj);
		//alert("cropped");
	} else{
	alert("no crop data")
	}
}


</script>
<script type="text/javascript">
function validateForm(x) {
	// This function deals with validation of the form fields
	var  y, i, valid = true;
	//x = document.getElementsByClassName("tab");
	y = x.querySelectorAll(".inp");
	// A loop that checks every input field in the current tab:
	for(i = 0; i < y.length; i++) {
		// If a field is empty...
		if(y[i].checkValidity() === false) {
			//if (y[i].value == "") {
			y[i].focus();
			Swal.fire("Reuired", y[i].getAttribute("data-title"))
				// add an "invalid" class to the field:
			y[i].className += " is-invalid";
			// and set the current valid status to false
			valid = false;
			return false;
		} else {
			y[i].className.replace(" is-invalid", "");
		}
	}
	// If the valid status is true, mark the step as finished and valid:
	if(valid) {
	//	document.getElementsByClassName("step")[currentTab].className += " finish";
	}
	return valid; // return the valid status
}

// get & store data
function getData(key, type="ses"){
	if (typeof(Storage) !== "undefined") {
		// Code for sessionStorage/sessionStorage.
		if(type == "ses"){
			return JSON.parse(sessionStorage.getItem(key));
		}else if(type=="loc"){
			return JSON.parse(localStorage.getItem(key));
		}
	} else {
		// Sorry! No Web Storage support..
		alert("Sorry! No Web Storage support..")
	}
}

function toJson(form){
	var fd = new FormData(form);
	var object = {};
	fd.forEach((value, key) => object[key] = value);
	return JSON.stringify(object);
}
function storeData(form,name,type="ses") {
	var fd = new FormData(form);
	var object = {};
	fd.forEach((value, key) => object[key] = value);
	var json = JSON.stringify(object);
	
	if (typeof(Storage) !== "undefined") {
	// Code for sessionStorage/sessionStorage.
		if(type == "ses"){
			sessionStorage.setItem(name, json);
		}else if(type == "loc"){
			sessionStorage.setItem(name, json);
		}
	} else {
	// Sorry! No Web Storage support..
	alert("Sorry! No Web Storage support..")
	}
}
function getFormData(object) {
    const formData = new FormData();
    Object.keys(object).forEach(key => formData.append(key, object[key]));
    return formData;
}
function subForm(obj) {
	/*const formData = new FormData();
	Object.keys(obj).forEach(key => formData.append(key, obj[key]));
	formData.append("cropped_img", croppedImgBlobData);
	*/
	Object.keys(obj).forEach(key => fd.append(key, obj[key]));
	fd.append('cropped_image', croppedImgBlobData, 'user.'+mimeType.slice(6));
	
	$.ajax("action.php", {
		method: "post",
		data: fd,
		processData: false,
		contentType: false,
		success: function(res) {
			alert("success: "+res);
			fd = "";
			tab1.reset();
			tab2.reset();
			tab3.reset();
			tab4.reset();
			$('select').prop('selectedIndex', 0);
		},
		error: function(err) {
			alert("err: "+err)
		},
		complete: function (e){
			alert("complete: "+JSON.stringify(e));
		}
	});
}

function validateInp(x) {
	if(x.checkValidity() === true) {
		x.classList.remove("is-invalid");
		x.classList.add("is-valid");
		//x.
	} else {
		x.classList.remove("is-valid");
		x.classList.add("is-invalid");
		//x.
	}
}

(function() {
	window.addEventListener('load', function() {
		// datepicker
		$("#dob").datepicker({
			changeMonth: true,
			changeYear: true,
			showAnim: "fadeIn",
			dateFormat: "dd-mm-yy",
			yearRange: "c-15:c+0",
			// defaultDate:"-3",
			showButtonPanel: false
		}).on({
			focus: function() {
				let _this = $(this);
				_this.attr('readonly', 'true');
			},
			blur: function() {
				$(this).removeAttr('readonly', 'false');
			}
		});
		$("#regForm .form-control, #regForm .form-select").on({
			keyup: function() {
				var _this = $(this);
				if(!(new RegExp(_this.attr("pattern")).test(_this.val()))) {
					_this.tooltip("show");
				} else {
					_this.tooltip("hide");
				}
			}
		});
		$('[data-toggle="tooltip"]').tooltip();
	
	
	
	
	}, false);
})();
</script>

<script type="text/javascript">


//window.addEventListener('DOMContentLoaded', function () {
  //var $preloader = $('.preloader');
  //var avatar = document.getElementById('avatar');
  var image = document.getElementById('croppable-img');
  var input = document.getElementById('select-img');
  var cropBtn = document.querySelector("#cropBtn")
  var rotateLeft = document.querySelector("#rotateLeft")
  var rotateRight = document.querySelector("#rotateRight")
  var flipX = document.querySelector("#flipX")
  var flipY = document.querySelector("#flipY")
  //var $progress = $('.progress');
  //var $progressBar = $('.progress-bar');
  //var $alert = $('.alert');
  var $modal = $('#cropImageModal');
  var mimeType = "image/jpeg";
  var cropper;

  //$('[data-toggle="tooltip"]').tooltip();

  input.addEventListener('change', function (e) {
    
    var files = e.target.files;
    var done = function (url) {
      input.value = '';
      image.src = url;
      //$preloader.fadeIn();
      //$alert.hide();
      $modal.modal('show');
    };
    var reader;
    var file;
    var url;

    if (files && files.length > 0) {
      file = files[0];

      if (URL) {
        done(URL.createObjectURL(file));
      } else if (FileReader) {
        reader = new FileReader();
        reader.onload = function (e) {
          done(reader.result);
        };
        reader.readAsDataURL(file);
      }
    }
  });

  $modal.on('shown.bs.modal', function () {
    cropper = new Cropper(image, {
      /*aspectRatio: 1,
      viewMode: 3,*/
      
     aspectRatio: 1,
     dragMode: 'move',
     //preview : '.croppingPreview',
     autoCropArea: 1,
     restore: !1,
     modal: !1,
     highlight: !1,
     fillColor: '#fff',
     cropBoxMovable: !1,
     cropBoxResizable: !1,
     toggleDragModeOnDblclick: !1,
     viewMode: 3,
     ready: function () {
         $modal.css("visibility","visible");
         //$preloader.fadeOut();
        // alert('load');
        $("[data-tool]").on("click", function (){
	        //cropper.rotate(45);
	        let tool = $(this).data("tool");
	        //alert(tool.data("tool")
	        switch(tool){
		        case "rotateLeft" : cropper.rotate(-45);
		        break;
		        case "rotateRight" : cropper.rotate(45);
		        break;
		        case "flipX" : cropper.scaleX(-1);
		        break;
		        case "flipY" : cropper.scaleY(-1);
		        break;
		        case "reset" : cropper.reset();
		        break;
		        
	        }
	        
        })
     }

    });
  }).on('hidden.bs.modal', function () {
    cropper.destroy();
    cropper = null;
      $modal.css("visibility","hidden");
  });

  document.getElementById('cropBtn').addEventListener('click', function () {
    //var initialAvatarURL;
    var canvas;

    $modal.modal('hide');

    if (cropper) {
      canvas = cropper.getCroppedCanvas({
        width: 600,
        height: 600,
      });
      //initialAvatarURL = avatar.src;
      //avatar.src = canvas.toDataURL();
      $("#user-img").attr('src', canvas.toDataURL())
      //$progress.show();
      //$alert.removeClass('alert-success alert-warning');
      canvas.toBlob(function (blob) {
      isImageCropped = true;
      croppedImgBlobData = blob;
      //fd.append('cropped_image', blob, 'user.'+mimeType.slice(6));
      /*/alert(blob);
        var formData = new FormData();

          formData.append('cropped_image', blob, 'user.'+mimeType.slice(6));
          formData.append('fileExt', mimeType.slice(6));
          formData.append('action', 'blob');
          
	      $.ajax('action.php', {
          method: 'POST',
          data: formData,
          processData: false,
          contentType: false,

          xhr: function () {
            var xhr = new XMLHttpRequest();

            xhr.upload.onprogress = function (e) {
              var percent = '0';
              var percentage = '0%';

              if (e.lengthComputable) {
                percent = Math.round((e.loaded / e.total) * 100);
                percentage = percent + '%';
                //$progressBar.width(percentage).attr('aria-valuenow', percent).text(percentage);
              }
            };

            return xhr;
          },

          success: function (res) {
            //$("#uploadImg").attr("src", res.imgPath);
            cropper = null;
            alert(res);
            //window.location.href = "./welcome";
            //$alert.show().addClass('alert-success').text(JSON.stringify(res));
          },

          error: function () {
            //avatar.src = initialAvatarURL;
            $alert.show().addClass('alert-warning').text('Upload error');
          },

          complete: function () {
            $progress.hide();
          },
        });*/
      
      
      }, mimeType);
    }
  });
//});

</script>
</body>

</html>